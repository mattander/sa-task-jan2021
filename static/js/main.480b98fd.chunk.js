(this["webpackJsonpsa-task-jan2021"]=this["webpackJsonpsa-task-jan2021"]||[]).push([[0],{46:function(e,t,c){},51:function(e,t,c){},74:function(e,t,c){"use strict";c.r(t);var a,r,n=c(1),s=c(0),i=c.n(s),o=c(14),d=c.n(o),l=(c(46),c(5)),u=(c(51),c(12)),b=c(40),j=c(13),h=c.n(j),O=c(18),m=c(11),x=c(22),k=c.n(x),p=Object(m.b)("currencies/getList",Object(O.a)(h.a.mark((function e(){var t,c,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.get("https://www.stackadapt.com/coinmarketcap/map?sort=cmc_rank").catch((function(e){console.error("Error while fetching available currencies"+e)}));case 2:return t=e.sent,c=t.data,a=t.status,e.abrupt("return",{data:c,status:a});case 6:case"end":return e.stop()}}),e)})))),f=Object(m.c)({name:"currencies",initialState:{loading:"idle",data:[],status:null},reducers:{},extraReducers:(a={},Object(u.a)(a,p.pending,(function(e){e.loading="pending"})),Object(u.a)(a,p.fulfilled,(function(e,t){var c=t.payload;e.data=Object(b.a)(c.data.data),e.status=c.data.status,e.loading="idle"})),Object(u.a)(a,p.rejected,(function(e){e.status="failed"})),a)}),g=function(e){return e.currencies},y=c(23),v=c(39),w=Object(m.b)("tracker/updateQuotes",function(){var e=Object(O.a)(h.a.mark((function e(t,c){var a,r,n,s,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.getState,console.log("quotes xhr"),r=a(),e.next=5,k.a.get("https://www.stackadapt.com/coinmarketcap/quotes?id=".concat(Object.keys(r.tracker.tracked).join(","))).then((function(e){return e})).catch((function(e){console.error("Error while fetching available currencies")}));case 5:return n=e.sent,s=n.data,i=n.status,e.abrupt("return",{data:s,status:i});case 9:case"end":return e.stop()}}),e)})));return function(t,c){return e.apply(this,arguments)}}()),N=Object(m.b)("debouncedAction",Object(v.debounce)(function(){var e=Object(O.a)(h.a.mark((function e(t,c){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,c.dispatch)(t);case 2:case"end":return e.stop()}}),e)})));return function(t,c){return e.apply(this,arguments)}}(),500)),S=Object(m.c)({name:"tracker",initialState:{loading:"idle",tracked:{},status:null,sort:{type:"CMC Rank",asc:!0}},reducers:{add:function(e,t){t.currencies.forEach((function(t){e.tracked[t.id]=t}))},remove:function(e,t){t.currencies.forEach((function(t){var c=t.id;delete e.tracked[c]}))},changeSort:function(e,t){var c=t.sort;e.sort=c}},extraReducers:(r={},Object(u.a)(r,w.pending,(function(e){e.loading="pending"})),Object(u.a)(r,w.fulfilled,(function(e,t){var c=t.payload;Object.entries(c.data.data).forEach((function(t){var c=Object(y.a)(t,2),a=c[0],r=c[1].quote;e.tracked[a].quote=r})),e.status=c.data.status,e.loading="idle"})),Object(u.a)(r,w.rejected,(function(e){e.status="failed"})),r)}),C=function(e){return Object.values(e.tracker.tracked).sort((function(t,c){switch(e.tracker.sort.type){case"Name":return t.name<c.name?e.tracker.sort.asc?-1:1:t.name>c.name?e.tracker.sort.asc?1:-1:0;case"Symbol":return t.symbol<c.symbol?e.tracker.sort.asc?-1:1:t.symbol>c.symbol?e.tracker.sort.asc?1:-1:0;case"Price (USD)":return e.tracker.sort.asc?t.quote.USD.price-c.quote.USD.price:c.quote.USD.price-t.quote.USD.price;default:return e.tracker.sort.asc?t.rank-c.rank:c.rank-t.rank}}))},q=function(e){return e.tracker.sort},D=c(10),U=c(8);function E(e){var t=e.currency,c=e.disabled,a=e.index,r=e.tracked,s=Object(l.b)(),i=[];r.hasOwnProperty(t.id)&&i.push("d-none");var o=["tracker-button"];return c?(o.push("disabled"),o.push("text-muted")):o.push("text-success"),Object(n.jsxs)("li",{className:i.join(" "),children:[Object(n.jsx)("button",{title:"Add ".concat(t.name," to tracking list"),disabled:c,className:o.join(" "),onClick:function(){s({type:"tracker/add",currencies:[{id:t.id,index:a}]})},"aria-label":"Track ".concat(t.name),children:Object(n.jsx)(D.a,{icon:U.d})}),t.name," (",t.symbol,")"]})}function R(){var e=Object(l.c)(g),t=Object(l.c)(C),c=e.data.map((function(e,c){return Object(n.jsx)(E,{currency:e,index:c,tracked:t,disabled:Object.entries(t).length>9},"untracked-currency-".concat(e.id))}));return Object(n.jsxs)("ul",{children:[Object.keys(t).length>9?Object(n.jsx)("div",{className:"text-danger mb-2",children:"You can't track more than 10 currencies at a time."}):null,c]})}function A(e){var t,c,a=e.currency,r=e.disabled,i=Object(l.b)();Object(s.useEffect)((function(){i(N(w()))}),[i]);var o=["tracker-button"];return r?(o.push("disabled"),o.push("text-muted")):o.push("text-danger"),Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{children:Object(n.jsx)("button",{title:"Remove ".concat(a.name," from tracking list"),className:o.join(" "),disabled:r,onClick:function(){i({type:"tracker/remove",currencies:[{id:a.id}]})},children:Object(n.jsx)(D.a,{icon:U.c})})}),Object(n.jsx)("td",{children:a.name}),Object(n.jsx)("td",{children:a.symbol}),Object(n.jsx)("td",{children:null!==(t=null!==(c=a.cmc_rank)&&void 0!==c?c:a.rank)&&void 0!==t?t:"Loading..."}),Object(n.jsx)("td",{children:a.quote&&a.quote.USD?"$".concat(a.quote.USD.price.toFixed(2)," (USD)"):"Loading..."})]})}function M(){var e=Object(l.b)(),t=Object(l.c)(C),c=Object(l.c)(q),a=Object.entries(t).map((function(e){var c=Object(y.a)(e,2),a=(c[0],c[1]);return Object(n.jsx)(A,{currency:a,disabled:Object.keys(t).length<2},"tracked-currency-".concat(a.id))})),r=function(t){t.target.innerText.trim()===c.type?e({type:"tracker/changeSort",sort:{type:c.type.trim(),asc:!c.asc}}):e({type:"tracker/changeSort",sort:{type:t.target.innerText.trim(),asc:!0}})};return Object(n.jsxs)("div",{className:"tracker-table-container",children:[Object(n.jsx)("div",{children:"Click a heading to sort"}),Object(n.jsxs)("table",{className:"tracker-table table table-striped table-borderless",children:[Object(n.jsx)("thead",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{}),Object(n.jsxs)("th",{className:"sortable-heading",onClick:r,children:["Name","Name"===c.type?Object(n.jsx)(D.a,{size:"xs",className:"ml-2",icon:c.asc?U.a:U.b}):null]}),Object(n.jsxs)("th",{className:"sortable-heading",onClick:r,children:["Symbol","Symbol"===c.type?Object(n.jsx)(D.a,{size:"xs",className:"ml-2",icon:c.asc?U.a:U.b}):null]}),Object(n.jsxs)("th",{className:"sortable-heading",onClick:r,children:["CMC Rank","CMC Rank"===c.type?Object(n.jsx)(D.a,{size:"xs",className:"ml-2",icon:c.asc?U.a:U.b}):null]}),Object(n.jsxs)("th",{className:"sortable-heading",onClick:r,children:["Price (USD)"," ","Price (USD)"===c.type?Object(n.jsx)(D.a,{size:"xs",className:"ml-2",icon:c.asc?U.a:U.b}):null]})]})}),Object(n.jsx)("tbody",{children:a})]}),Object.keys(t).length<2?Object(n.jsx)("div",{className:"text-danger mb-2",children:"You can't track less than one currency at a time."}):null]})}var T=c(20);var z=function(){var e=Object(l.b)(),t=Object(l.c)(g),c=t.data;Object(s.useEffect)((function(){0===c.length&&e(p())}),[e,c]),Object(s.useEffect)((function(){t.data.length>0&&e({type:"tracker/add",currencies:t.data.slice(0,5)})}),[e,t]);var a="failed"!==t.status?Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col-12 col-md-8 col-lg-7",children:[Object(n.jsx)("div",{className:"d-flex justify-content-end my-2",children:Object(n.jsxs)(T.a,{className:"currencies-dropdown",children:[Object(n.jsx)(T.a.Toggle,{variant:"primary",id:"currencyListDropdown",children:"Add currencies"}),Object(n.jsxs)(T.a.Menu,{children:[Object(n.jsx)(T.a.Header,{children:"Available currencies"}),Object(n.jsx)(R,{})]})]})}),Object(n.jsx)(M,{})]})}):Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("div",{className:"col",children:Object(n.jsxs)("div",{className:"alert alert-danger",role:"alert",children:[Object(n.jsx)("p",{children:"Uh oh. Something went wrong when fetching the list of trackable currencies."}),Object(n.jsx)("p",{children:"You can try again now or come back later."}),Object(n.jsx)("button",{className:"btn btn-primary mt-2",onClick:function(){e(p())},children:"Try again"})]})})});return Object(n.jsx)("div",{className:"App",children:Object(n.jsxs)("div",{className:"container",children:[Object(n.jsx)("h1",{children:"Cryptocurrency tracker"}),a]})})},L=Object(m.a)({reducer:{currencies:f.reducer,tracker:S.reducer}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));d.a.render(Object(n.jsx)(i.a.StrictMode,{children:Object(n.jsx)(l.a,{store:L,children:Object(n.jsx)(z,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[74,1,2]]]);
//# sourceMappingURL=main.480b98fd.chunk.js.map